graph TD
    %% User Input and API Layer
    USER[ğŸ‘¤ User Input<br/>Natural Language Query] --> API[ğŸ“¡ Module 2 API<br/>Hybrid Cortex Engine]
    
    %% Azure OpenAI Services
    subgraph AZURE[ğŸ¤– Azure OpenAI Services]
        EMBED[ğŸ“Š Embedding Generation<br/>text-embedding-ada-002<br/>1536 dimensions]
        CHAT[ğŸ’¬ Chat Completion<br/>gpt-4o-mini<br/>Natural Language Response]
    end
    
    %% Snowflake Services
    subgraph SNOWFLAKE[ğŸ”ï¸ Snowflake Data Platform]
        VECTOR_STORE[ğŸ“ Vector Storage<br/>VECTOR(FLOAT, 1536)<br/>Persistent Storage]
        SIMILARITY[ğŸ” Similarity Search<br/>VECTOR_COSINE_SIMILARITY<br/>Native Performance]
        GEO_DATA[ğŸ—ƒï¸ Geological Data<br/>Module 1 Integration<br/>114k+ Reports]
    end
    
    %% Workflow Paths
    API --> EMBED
    API --> CHAT
    
    %% Embedding and Storage Flow
    EMBED --> VECTOR_STORE
    GEO_DATA --> EMBED
    
    %% Search and Retrieval Flow
    EMBED -.Query Embedding.-> SIMILARITY
    SIMILARITY --> VECTOR_STORE
    SIMILARITY -.Context.-> CHAT
    
    %% Response Flow
    CHAT --> API
    API --> USER
    
    %% Data Processing Pipeline
    subgraph PIPELINE[âš™ï¸ Data Processing Pipeline]
        FETCH[ğŸ“¥ Fetch Geological Data<br/>FROM geological_reports]
        PROCESS[ğŸ”„ Process Text<br/>Title + Commodities + Operator]
        STORE[ğŸ’¾ Store Embeddings<br/>INSERT INTO vector_tables]
    end
    
    GEO_DATA --> FETCH
    FETCH --> PROCESS
    PROCESS --> EMBED
    EMBED --> STORE
    STORE --> VECTOR_STORE
    
    %% Styling
    style USER fill:#e3f2fd
    style API fill:#f3e5f5
    style AZURE fill:#fff3e0
    style SNOWFLAKE fill:#e8f5e8
    style PIPELINE fill:#fce4ec
    
    %% Performance Annotations
    EMBED -.< 2sec.-> VECTOR_STORE
    SIMILARITY -.< 500ms.-> CHAT
    CHAT -.< 5sec.-> API 